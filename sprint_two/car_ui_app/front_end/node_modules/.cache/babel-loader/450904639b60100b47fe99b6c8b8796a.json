{"ast":null,"code":"import axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport store from '../store/store';\nimport { initiateGetProfile } from '../actions/profile';\nimport { signIn } from '../actions/auth';\nimport { history } from '../router/appRouter'; //Returns a bool\n\nexport const validateFields = fieldsToValidate => {\n  return fieldsToValidate.every(field => Object.values(field)[0] !== '');\n};\nexport const maintainSession = () => {\n  const user_token = localStorage.getItem('user_token');\n\n  if (user_token) {\n    const currentPath = window.location.pathname;\n\n    if (currentPath === '/' || currentPath === '/register') {\n      history.push('/profile');\n    }\n\n    const decoded = jwt_decode(user_token);\n    updateStore(decoded);\n  } else {\n    history.push('/');\n  }\n};\nexport const updateStore = user => {\n  const {\n    profile_id,\n    profile_name\n  } = user;\n  store.dispatch(signIn({\n    profile_id,\n    profile_name,\n    token: localStorage.getItem('user_token')\n  }));\n  store.dispatch(initiateGetProfile(profile_name));\n};\nexport const setAuthHeader = () => {\n  const token = localStorage.getItem('user_token');\n\n  if (token) {\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n  }\n};\nexport const removeAuthHeader = () => {\n  delete axios.defaults.headers.common['Authorization'];\n};","map":{"version":3,"sources":["I:/Team-Matrix/sprint_two/car_ui_app/front_end/src/utils/common.js"],"names":["axios","jwt_decode","store","initiateGetProfile","signIn","history","validateFields","fieldsToValidate","every","field","Object","values","maintainSession","user_token","localStorage","getItem","currentPath","window","location","pathname","push","decoded","updateStore","user","profile_id","profile_name","dispatch","token","setAuthHeader","defaults","headers","common","removeAuthHeader"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;AACA,SAASC,kBAAT,QAAmC,oBAAnC;AACA,SAASC,MAAT,QAAuB,iBAAvB;AACA,SAASC,OAAT,QAAwB,qBAAxB,C,CAEA;;AACA,OAAO,MAAMC,cAAc,GAAIC,gBAAD,IAAsB;AAClD,SAAOA,gBAAgB,CAACC,KAAjB,CAAwBC,KAAD,IAAWC,MAAM,CAACC,MAAP,CAAcF,KAAd,EAAqB,CAArB,MAA4B,EAA9D,CAAP;AACD,CAFM;AAIP,OAAO,MAAMG,eAAe,GAAG,MAAM;AACnC,QAAMC,UAAU,GAAGC,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAnB;;AACA,MAAIF,UAAJ,EACA;AACE,UAAMG,WAAW,GAAGC,MAAM,CAACC,QAAP,CAAgBC,QAApC;;AACA,QAAIH,WAAW,KAAK,GAAhB,IAAuBA,WAAW,KAAK,WAA3C,EACA;AACEX,MAAAA,OAAO,CAACe,IAAR,CAAa,UAAb;AACD;;AACD,UAAMC,OAAO,GAAGpB,UAAU,CAACY,UAAD,CAA1B;AACAS,IAAAA,WAAW,CAACD,OAAD,CAAX;AACD,GATD,MAWA;AACEhB,IAAAA,OAAO,CAACe,IAAR,CAAa,GAAb;AACD;AACF,CAhBM;AAkBP,OAAO,MAAME,WAAW,GAAIC,IAAD,IAAU;AACnC,QAAM;AAACC,IAAAA,UAAD;AAAaC,IAAAA;AAAb,MAA6BF,IAAnC;AACArB,EAAAA,KAAK,CAACwB,QAAN,CAAetB,MAAM,CAAC;AAACoB,IAAAA,UAAD;AAAaC,IAAAA,YAAb;AAA2BE,IAAAA,KAAK,EAAEb,YAAY,CAACC,OAAb,CAAqB,YAArB;AAAlC,GAAD,CAArB;AACAb,EAAAA,KAAK,CAACwB,QAAN,CAAevB,kBAAkB,CAACsB,YAAD,CAAjC;AACD,CAJM;AAMP,OAAO,MAAMG,aAAa,GAAG,MAAM;AACjC,QAAMD,KAAK,GAAGb,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAd;;AACA,MAAIY,KAAJ,EACA;AACE3B,IAAAA,KAAK,CAAC6B,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAkD,UAASJ,KAAM,EAAjE;AACD;AACF,CANM;AAQP,OAAO,MAAMK,gBAAgB,GAAG,MAAM;AACpC,SAAOhC,KAAK,CAAC6B,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,CAAP;AACD,CAFM","sourcesContent":["import axios from 'axios';\r\nimport jwt_decode from 'jwt-decode';\r\nimport store from '../store/store';\r\nimport { initiateGetProfile } from '../actions/profile';\r\nimport { signIn } from '../actions/auth';\r\nimport { history } from '../router/appRouter';\r\n\r\n//Returns a bool\r\nexport const validateFields = (fieldsToValidate) => {\r\n  return fieldsToValidate.every((field) => Object.values(field)[0] !== '');\r\n};\r\n\r\nexport const maintainSession = () => {\r\n  const user_token = localStorage.getItem('user_token');\r\n  if (user_token) \r\n  {\r\n    const currentPath = window.location.pathname;\r\n    if (currentPath === '/' || currentPath === '/register') \r\n    {\r\n      history.push('/profile');\r\n    }\r\n    const decoded = jwt_decode(user_token);\r\n    updateStore(decoded);\r\n  } \r\n  else \r\n  {\r\n    history.push('/');\r\n  }\r\n};\r\n\r\nexport const updateStore = (user) => {\r\n  const {profile_id, profile_name} = user;\r\n  store.dispatch(signIn({profile_id, profile_name, token: localStorage.getItem('user_token')}));\r\n  store.dispatch(initiateGetProfile(profile_name));\r\n};\r\n\r\nexport const setAuthHeader = () => {\r\n  const token = localStorage.getItem('user_token');\r\n  if (token) \r\n  {\r\n    axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n  }\r\n};\r\n\r\nexport const removeAuthHeader = () => {\r\n  delete axios.defaults.headers.common['Authorization'];\r\n};"]},"metadata":{},"sourceType":"module"}